<!-- web_app/templates/payment.html -->
{% extends 'base.html' %}

{% block content %}
  <div class="container mt-5">
    <h2>Subscribe Now</h2>
    <button id="checkout-button" class="btn btn-primary">Checkout</button>
  </div>

  <script src="https://js.stripe.com/v3/"></script>
  <script>
    const stripe = Stripe('{{ stripe_public_key }}');

    document.getElementById('checkout-button').addEventListener('click', function () {
      fetch('/payment/create-checkout-session', {
        method: 'POST',
      })
        .then(function (response) {
          return response.json();
        })
        .then(function (session) {
          return stripe.redirectToCheckout({ sessionId: session.sessionId });
        })
        .catch(function (error) {
          console.error('Error:', error);
        });
    });
  </script>
{% endblock %}